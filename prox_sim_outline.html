<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>PROX Simulation Specs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="prox_sim_outline_files/libs/clipboard/clipboard.min.js"></script>
<script src="prox_sim_outline_files/libs/quarto-html/quarto.js"></script>
<script src="prox_sim_outline_files/libs/quarto-html/popper.min.js"></script>
<script src="prox_sim_outline_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="prox_sim_outline_files/libs/quarto-html/anchor.min.js"></script>
<link href="prox_sim_outline_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="prox_sim_outline_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="prox_sim_outline_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="prox_sim_outline_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="prox_sim_outline_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">PROX Simulation Specs</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="prox-simulation-outline" class="level2">
<h2 class="anchored" data-anchor-id="prox-simulation-outline">PROX Simulation Outline</h2>
<p>This simulation will compare the recovery of simulated ability parameters using different ability estimation functions with fixed item parameter estimates. The PROX method <span class="citation" data-cites="cohen1972">[@cohen1972]</span> will be compared to:</p>
<ul>
<li>Joint Maximum Likelihood Estimation (JMLE; TAM package) <em>Can use fixed item parameters</em></li>
<li>Marginal Maximum Likelihood Estimation (MMLE; TAM or ltm package) <em>TAM uses EAP after MMLE</em></li>
<li>Conditional Maximum Likelihood Estimation (CMLE; Winsteps) <em>Can use fixed item parameters, takes magnitudes longer than the other methods (~2 minutes in condition 1)</em></li>
<li>Expected a Posteriori estimator (EAP; irtoys package) <em>Uses LTM as the backend, can use fixed item parameters</em></li>
</ul>
<p>The comparisons between these estimation methods will look at different distributions of person abilities and different sample sizes of responses. The different levels of these factors are:</p>
<ul>
<li>Parameter Distributions:
<ul>
<li><p>Both items and persons: A standard normal distribution, <span class="math inline">\(\theta \sim \mathcal{N}(\mu = 0, \sigma^2 = 1)\)</span></p></li>
<li><p>Both items and persons: <span class="math inline">\(\theta \sim \mathcal{N}(0, 2)\)</span></p></li>
<li><p>Items = <span class="math inline">\(\theta \sim \mathcal{N}(-1, 1)\)</span> and Persons = <span class="math inline">\(\theta \sim \mathcal{N}(1, 1)\)</span></p></li>
<li><p>Items = <span class="math inline">\(\theta \sim \mathcal{N}(-2, 1)\)</span> and Persons = <span class="math inline">\(\theta \sim \mathcal{N}(2, 1)\)</span></p></li>
<li><p>Items = <span class="math inline">\(\theta \sim \mathcal{N}(-3, 1)\)</span> and Persons = <span class="math inline">\(\theta \sim \mathcal{N}(3, 1)\)</span></p></li>
<li><p>Items = <span class="math inline">\(\theta \sim \mathcal{N}(0, 1)\)</span> and Persons = bimodal mixture distribution with equal <span class="math inline">\(\sigma^2 = 0.5\)</span> and modes <span class="math inline">\(\mathcal{Mo}_1 = -1.5\)</span> and <span class="math inline">\(\mathcal{Mo}_2 = 1.5\)</span></p></li>
<li><p>Items = bimodal mixture distribution with equal <span class="math inline">\(\sigma^2 = 0.5\)</span> and modes <span class="math inline">\(\mathcal{Mo}_1 = -1.5\)</span> and <span class="math inline">\(\mathcal{Mo}_2 = 1.5\)</span> and Persons = <span class="math inline">\(\theta \sim \mathcal{N}(0, 1)\)</span></p></li>
</ul></li>
<li>Person Sample sizes:
<ul>
<li><span class="math inline">\(n = 25\)</span></li>
<li><span class="math inline">\(n = 50\)</span></li>
<li><span class="math inline">\(n = 100\)</span></li>
<li><span class="math inline">\(n = 200\)</span></li>
<li><span class="math inline">\(n = 500\)</span></li>
<li><span class="math inline">\(n = 1000\)</span></li>
</ul></li>
</ul>
<p>Here is a table of each condition label and its parameter values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: tidyverse</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>person_sample_sizes <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>number_items <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>parameter_distribution_condition <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Standard Normal"</span>, <span class="st">"Wide Normal"</span>, <span class="st">"-1 Item Diff, +1 Person Theta"</span>, <span class="st">"-2 Item Diff, +2 Person Theta"</span>, <span class="st">"-3 Item Diff, +3 Person Theta"</span>, <span class="st">"Normal Items, Bimodal Persons"</span>, <span class="st">"Bimodal Items, Normal Persons"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>conditions <span class="ot">=</span> <span class="fu">expand.grid</span>(person_sample_sizes, number_items, parameter_distribution_condition)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>conditions <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">paste0</span>(<span class="st">"Condition "</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(conditions)), conditions)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>conditions <span class="ot">=</span> conditions[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>)]</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(conditions) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Condition"</span>, <span class="st">"Item_and_Person_Params"</span>, <span class="st">"Items"</span>, <span class="st">"N"</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>conditions <span class="ot">=</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  conditions <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Condition =</span> </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">case_when</span>(</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">grepl</span>(<span class="st">" [0-9]{1}$"</span>, Condition) <span class="sc">~</span> <span class="fu">str_replace</span>(Condition, <span class="st">"Condition "</span>, <span class="st">"Condition 0"</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    , <span class="cn">TRUE</span> <span class="sc">~</span> Condition</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(conditions, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Condition Number"</span>, <span class="st">"Item/Person Parameters"</span>, <span class="st">"Number of Items"</span>, <span class="st">"Number of Persons"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 37%">
<col style="width: 19%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Condition Number</th>
<th style="text-align: left;">Item/Person Parameters</th>
<th style="text-align: right;">Number of Items</th>
<th style="text-align: right;">Number of Persons</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Condition 01</td>
<td style="text-align: left;">Standard Normal</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 02</td>
<td style="text-align: left;">Standard Normal</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 03</td>
<td style="text-align: left;">Standard Normal</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 04</td>
<td style="text-align: left;">Standard Normal</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 05</td>
<td style="text-align: left;">Standard Normal</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 06</td>
<td style="text-align: left;">Standard Normal</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 07</td>
<td style="text-align: left;">Standard Normal</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 08</td>
<td style="text-align: left;">Standard Normal</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 09</td>
<td style="text-align: left;">Standard Normal</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 10</td>
<td style="text-align: left;">Standard Normal</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 11</td>
<td style="text-align: left;">Standard Normal</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 12</td>
<td style="text-align: left;">Standard Normal</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 13</td>
<td style="text-align: left;">Standard Normal</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 14</td>
<td style="text-align: left;">Standard Normal</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 15</td>
<td style="text-align: left;">Standard Normal</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 16</td>
<td style="text-align: left;">Standard Normal</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 17</td>
<td style="text-align: left;">Standard Normal</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 18</td>
<td style="text-align: left;">Standard Normal</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 19</td>
<td style="text-align: left;">Wide Normal</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 20</td>
<td style="text-align: left;">Wide Normal</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 21</td>
<td style="text-align: left;">Wide Normal</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 22</td>
<td style="text-align: left;">Wide Normal</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 23</td>
<td style="text-align: left;">Wide Normal</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 24</td>
<td style="text-align: left;">Wide Normal</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 25</td>
<td style="text-align: left;">Wide Normal</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 26</td>
<td style="text-align: left;">Wide Normal</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 27</td>
<td style="text-align: left;">Wide Normal</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 28</td>
<td style="text-align: left;">Wide Normal</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 29</td>
<td style="text-align: left;">Wide Normal</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 30</td>
<td style="text-align: left;">Wide Normal</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 31</td>
<td style="text-align: left;">Wide Normal</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 32</td>
<td style="text-align: left;">Wide Normal</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 33</td>
<td style="text-align: left;">Wide Normal</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 34</td>
<td style="text-align: left;">Wide Normal</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 35</td>
<td style="text-align: left;">Wide Normal</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 36</td>
<td style="text-align: left;">Wide Normal</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 37</td>
<td style="text-align: left;">-1 Item Diff, +1 Person Theta</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 38</td>
<td style="text-align: left;">-1 Item Diff, +1 Person Theta</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 39</td>
<td style="text-align: left;">-1 Item Diff, +1 Person Theta</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 40</td>
<td style="text-align: left;">-1 Item Diff, +1 Person Theta</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 41</td>
<td style="text-align: left;">-1 Item Diff, +1 Person Theta</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 42</td>
<td style="text-align: left;">-1 Item Diff, +1 Person Theta</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 43</td>
<td style="text-align: left;">-1 Item Diff, +1 Person Theta</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 44</td>
<td style="text-align: left;">-1 Item Diff, +1 Person Theta</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 45</td>
<td style="text-align: left;">-1 Item Diff, +1 Person Theta</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 46</td>
<td style="text-align: left;">-1 Item Diff, +1 Person Theta</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 47</td>
<td style="text-align: left;">-1 Item Diff, +1 Person Theta</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 48</td>
<td style="text-align: left;">-1 Item Diff, +1 Person Theta</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 49</td>
<td style="text-align: left;">-1 Item Diff, +1 Person Theta</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 50</td>
<td style="text-align: left;">-1 Item Diff, +1 Person Theta</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 51</td>
<td style="text-align: left;">-1 Item Diff, +1 Person Theta</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 52</td>
<td style="text-align: left;">-1 Item Diff, +1 Person Theta</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 53</td>
<td style="text-align: left;">-1 Item Diff, +1 Person Theta</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 54</td>
<td style="text-align: left;">-1 Item Diff, +1 Person Theta</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 55</td>
<td style="text-align: left;">-2 Item Diff, +2 Person Theta</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 56</td>
<td style="text-align: left;">-2 Item Diff, +2 Person Theta</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 57</td>
<td style="text-align: left;">-2 Item Diff, +2 Person Theta</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 58</td>
<td style="text-align: left;">-2 Item Diff, +2 Person Theta</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 59</td>
<td style="text-align: left;">-2 Item Diff, +2 Person Theta</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 60</td>
<td style="text-align: left;">-2 Item Diff, +2 Person Theta</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 61</td>
<td style="text-align: left;">-2 Item Diff, +2 Person Theta</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 62</td>
<td style="text-align: left;">-2 Item Diff, +2 Person Theta</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 63</td>
<td style="text-align: left;">-2 Item Diff, +2 Person Theta</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 64</td>
<td style="text-align: left;">-2 Item Diff, +2 Person Theta</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 65</td>
<td style="text-align: left;">-2 Item Diff, +2 Person Theta</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 66</td>
<td style="text-align: left;">-2 Item Diff, +2 Person Theta</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 67</td>
<td style="text-align: left;">-2 Item Diff, +2 Person Theta</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 68</td>
<td style="text-align: left;">-2 Item Diff, +2 Person Theta</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 69</td>
<td style="text-align: left;">-2 Item Diff, +2 Person Theta</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 70</td>
<td style="text-align: left;">-2 Item Diff, +2 Person Theta</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 71</td>
<td style="text-align: left;">-2 Item Diff, +2 Person Theta</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 72</td>
<td style="text-align: left;">-2 Item Diff, +2 Person Theta</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 73</td>
<td style="text-align: left;">-3 Item Diff, +3 Person Theta</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 74</td>
<td style="text-align: left;">-3 Item Diff, +3 Person Theta</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 75</td>
<td style="text-align: left;">-3 Item Diff, +3 Person Theta</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 76</td>
<td style="text-align: left;">-3 Item Diff, +3 Person Theta</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 77</td>
<td style="text-align: left;">-3 Item Diff, +3 Person Theta</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 78</td>
<td style="text-align: left;">-3 Item Diff, +3 Person Theta</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 79</td>
<td style="text-align: left;">-3 Item Diff, +3 Person Theta</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 80</td>
<td style="text-align: left;">-3 Item Diff, +3 Person Theta</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 81</td>
<td style="text-align: left;">-3 Item Diff, +3 Person Theta</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 82</td>
<td style="text-align: left;">-3 Item Diff, +3 Person Theta</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 83</td>
<td style="text-align: left;">-3 Item Diff, +3 Person Theta</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 84</td>
<td style="text-align: left;">-3 Item Diff, +3 Person Theta</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 85</td>
<td style="text-align: left;">-3 Item Diff, +3 Person Theta</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 86</td>
<td style="text-align: left;">-3 Item Diff, +3 Person Theta</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 87</td>
<td style="text-align: left;">-3 Item Diff, +3 Person Theta</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 88</td>
<td style="text-align: left;">-3 Item Diff, +3 Person Theta</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 89</td>
<td style="text-align: left;">-3 Item Diff, +3 Person Theta</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 90</td>
<td style="text-align: left;">-3 Item Diff, +3 Person Theta</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 91</td>
<td style="text-align: left;">Normal Items, Bimodal Persons</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 92</td>
<td style="text-align: left;">Normal Items, Bimodal Persons</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 93</td>
<td style="text-align: left;">Normal Items, Bimodal Persons</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 94</td>
<td style="text-align: left;">Normal Items, Bimodal Persons</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 95</td>
<td style="text-align: left;">Normal Items, Bimodal Persons</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 96</td>
<td style="text-align: left;">Normal Items, Bimodal Persons</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 97</td>
<td style="text-align: left;">Normal Items, Bimodal Persons</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 98</td>
<td style="text-align: left;">Normal Items, Bimodal Persons</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 99</td>
<td style="text-align: left;">Normal Items, Bimodal Persons</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 100</td>
<td style="text-align: left;">Normal Items, Bimodal Persons</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 101</td>
<td style="text-align: left;">Normal Items, Bimodal Persons</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 102</td>
<td style="text-align: left;">Normal Items, Bimodal Persons</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 103</td>
<td style="text-align: left;">Normal Items, Bimodal Persons</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 104</td>
<td style="text-align: left;">Normal Items, Bimodal Persons</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 105</td>
<td style="text-align: left;">Normal Items, Bimodal Persons</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 106</td>
<td style="text-align: left;">Normal Items, Bimodal Persons</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 107</td>
<td style="text-align: left;">Normal Items, Bimodal Persons</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 108</td>
<td style="text-align: left;">Normal Items, Bimodal Persons</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 109</td>
<td style="text-align: left;">Bimodal Items, Normal Persons</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 110</td>
<td style="text-align: left;">Bimodal Items, Normal Persons</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 111</td>
<td style="text-align: left;">Bimodal Items, Normal Persons</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 112</td>
<td style="text-align: left;">Bimodal Items, Normal Persons</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 113</td>
<td style="text-align: left;">Bimodal Items, Normal Persons</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 114</td>
<td style="text-align: left;">Bimodal Items, Normal Persons</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 115</td>
<td style="text-align: left;">Bimodal Items, Normal Persons</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 116</td>
<td style="text-align: left;">Bimodal Items, Normal Persons</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 117</td>
<td style="text-align: left;">Bimodal Items, Normal Persons</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 118</td>
<td style="text-align: left;">Bimodal Items, Normal Persons</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 119</td>
<td style="text-align: left;">Bimodal Items, Normal Persons</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 120</td>
<td style="text-align: left;">Bimodal Items, Normal Persons</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 121</td>
<td style="text-align: left;">Bimodal Items, Normal Persons</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 122</td>
<td style="text-align: left;">Bimodal Items, Normal Persons</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 123</td>
<td style="text-align: left;">Bimodal Items, Normal Persons</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 124</td>
<td style="text-align: left;">Bimodal Items, Normal Persons</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition 125</td>
<td style="text-align: left;">Bimodal Items, Normal Persons</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition 126</td>
<td style="text-align: left;">Bimodal Items, Normal Persons</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">1000</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>conditions_save <span class="ot">&lt;-</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  conditions <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">filename =</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>      Condition <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_replace</span>(<span class="st">" "</span>, <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_replace</span>(<span class="st">"_0"</span>, <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"_estimates.RDS"</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>conditions_save <span class="sc">%&gt;%</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">"results/conditions.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-the-data" class="level2">
<h2 class="anchored" data-anchor-id="creating-the-data">Creating the data</h2>
<p>The following code chunk provides some setup for the simulation. It loads the required packages and defines functions to simulate the response data for analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(TAM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: TAM</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: CDM</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: mvtnorm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>**********************************
** CDM 8.2-6 (2022-08-25 15:43:23)       
** Cognitive Diagnostic Models  **
**********************************</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>* TAM 4.1-4 (2022-08-28 16:03:54)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(eRm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: eRm</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(irtoys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: irtoys</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: sm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Package 'sm', version 2.2-5.7: type help(sm) for summary information</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ltm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MASS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:sm':

    muscle</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: msm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: polycor</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>rasch_response_sim <span class="ot">=</span> <span class="cf">function</span>(person_theta_value, item_diff_value) {</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  resp_prob <span class="ot">=</span> <span class="fu">exp</span>(person_theta_value <span class="sc">-</span> item_diff_value) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(person_theta_value <span class="sc">-</span> item_diff_value))</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  response <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">test =</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="fu">length</span>(resp_prob)) <span class="sc">&lt;=</span> resp_prob,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">yes =</span> <span class="dv">1</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">no =</span> <span class="dv">0</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(response)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>prox_estimate <span class="ot">=</span> <span class="cf">function</span>(mean_item_diff, sd_item_diff, observed_raw_score, maximum_score) {</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  estimate <span class="ot">&lt;-</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    mean_item_diff <span class="sc">+</span> </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">+</span> sd_item_diff<span class="sc">/</span><span class="fl">2.9</span>) <span class="sc">*</span> </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(observed_raw_score<span class="sc">/</span>(maximum_score <span class="sc">-</span> observed_raw_score))</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  estimate <span class="ot">&lt;-</span> </span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(estimate <span class="sc">==</span> <span class="cn">Inf</span>, <span class="dv">6</span>,</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ifelse</span>(estimate <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="sc">-</span><span class="dv">6</span>, </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>                  estimate</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  estimate</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>winsteps_estimate <span class="ot">=</span> <span class="cf">function</span>(</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">item_anchor_file =</span> <span class="st">"sim.anchor"</span>,</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_file =</span> <span class="st">'test.dat'</span>,</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">scores_file =</span> <span class="st">'theta.out'</span>,</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="cn">NULL</span>,</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">item_params =</span> items</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>    ) {</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(tidyverse)</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># data file:</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>    data <span class="sc">%&gt;%</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">delim =</span> <span class="st">"*"</span>, <span class="at">.after =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">id_cols =</span> <span class="fu">c</span>(id, delim)</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>      , <span class="at">names_from =</span> item</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>      , <span class="at">values_from =</span> response</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>  test_data <span class="sc">%&gt;%</span></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write_delim</span>(<span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">'temp/'</span>, data_file), <span class="at">delim =</span> <span class="st">''</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># item files:</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>  item_order <span class="ot">&lt;-</span> </span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">ItemID =</span> <span class="fu">colnames</span>(test_data)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)])</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>  n_items <span class="ot">=</span> <span class="fu">nrow</span>(item_order)</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>  item_anchor_content <span class="ot">&lt;-</span></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>    item_order <span class="sc">%&gt;%</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>      item_params <span class="sc">%&gt;%</span></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(ItemID, IRTb) <span class="sc">%&gt;%</span></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>        <span class="fu">distinct</span>()</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">seq =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(seq, IRTb, ItemID)</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>  item_anchor_content <span class="sc">%&gt;%</span></span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">delim =</span> <span class="st">";"</span>, <span class="at">.before =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write_tsv</span>(<span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">'temp/'</span>, item_anchor_file), <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># control file:</span></span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>  control <span class="ot">&lt;-</span></span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a><span class="st">'IAFILE='</span>, item_anchor_file, <span class="st">';</span></span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a><span class="st">;******************************************</span></span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a><span class="st">;Estimation &amp; Convergence Criteria</span></span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a><span class="st">;******************************************</span></span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a><span class="st">MPROX=20                    ; Maximum of 20 PROX iterations</span></span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a><span class="st">CMLE=Yes                  ; Use CMLE</span></span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a><span class="st">;MJMLE=0                  ; Unlimited JMLE iterations</span></span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a><span class="st">;XMLE=Yes                 ; Use XMLE=YES when calibrating items BUT XMLE=NO when computing person ability estimates</span></span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a><span class="st">CONVERGE=L                ; </span></span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a><span class="st">LCONV=.0001               ; Stop iterating when the largest change is &lt; 0.0001 logits</span></span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a><span class="st">;RCONV=0.1                  ; RCONV is not useful when anchor values are used. </span></span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a><span class="st">UDECIM=4                    ; Compute Estimates to 4 decimal places</span></span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a><span class="st">TFILE=*</span></span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a><span class="st">3.1</span></span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a><span class="st">3.2</span></span>
<span id="cb25-82"><a href="#cb25-82" aria-hidden="true" tabindex="-1"></a><span class="st">*;</span></span>
<span id="cb25-83"><a href="#cb25-83" aria-hidden="true" tabindex="-1"></a><span class="st">;******************************************</span></span>
<span id="cb25-84"><a href="#cb25-84" aria-hidden="true" tabindex="-1"></a><span class="st">;Input Data Format</span></span>
<span id="cb25-85"><a href="#cb25-85" aria-hidden="true" tabindex="-1"></a><span class="st">;******************************************</span></span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a><span class="st">CODES=01;</span></span>
<span id="cb25-87"><a href="#cb25-87" aria-hidden="true" tabindex="-1"></a><span class="st">DATA='</span>, data_file, <span class="st">';</span></span>
<span id="cb25-88"><a href="#cb25-88" aria-hidden="true" tabindex="-1"></a><span class="st">NAME1=1;</span></span>
<span id="cb25-89"><a href="#cb25-89" aria-hidden="true" tabindex="-1"></a><span class="st">NAMLEN=4;</span></span>
<span id="cb25-90"><a href="#cb25-90" aria-hidden="true" tabindex="-1"></a><span class="st">ITEM=Item;</span></span>
<span id="cb25-91"><a href="#cb25-91" aria-hidden="true" tabindex="-1"></a><span class="st">ITEM1=6</span></span>
<span id="cb25-92"><a href="#cb25-92" aria-hidden="true" tabindex="-1"></a><span class="st">NI='</span>, n_items, <span class="st">';</span></span>
<span id="cb25-93"><a href="#cb25-93" aria-hidden="true" tabindex="-1"></a><span class="st">;******************************************</span></span>
<span id="cb25-94"><a href="#cb25-94" aria-hidden="true" tabindex="-1"></a><span class="st">; Output Files</span></span>
<span id="cb25-95"><a href="#cb25-95" aria-hidden="true" tabindex="-1"></a><span class="st">;******************************************</span></span>
<span id="cb25-96"><a href="#cb25-96" aria-hidden="true" tabindex="-1"></a><span class="st">PFILE='</span>, scores_file,<span class="st">';</span></span>
<span id="cb25-97"><a href="#cb25-97" aria-hidden="true" tabindex="-1"></a><span class="st">;******************************************</span></span>
<span id="cb25-98"><a href="#cb25-98" aria-hidden="true" tabindex="-1"></a><span class="st">; Item Labels</span></span>
<span id="cb25-99"><a href="#cb25-99" aria-hidden="true" tabindex="-1"></a><span class="st">;******************************************</span></span>
<span id="cb25-100"><a href="#cb25-100" aria-hidden="true" tabindex="-1"></a><span class="st">&amp;END</span></span>
<span id="cb25-101"><a href="#cb25-101" aria-hidden="true" tabindex="-1"></a><span class="st">'</span>, <span class="fu">paste0</span>(item_order<span class="sc">$</span>ItemID, <span class="at">collapse =</span> <span class="st">' </span><span class="sc">\n</span><span class="st">'</span>), <span class="st">'</span></span>
<span id="cb25-102"><a href="#cb25-102" aria-hidden="true" tabindex="-1"></a><span class="st">END LABELS'</span></span>
<span id="cb25-103"><a href="#cb25-103" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-104"><a href="#cb25-104" aria-hidden="true" tabindex="-1"></a>  control <span class="sc">%&gt;%</span></span>
<span id="cb25-105"><a href="#cb25-105" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write_lines</span>(<span class="st">'temp/overall_control.ctr'</span>)</span>
<span id="cb25-106"><a href="#cb25-106" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-107"><a href="#cb25-107" aria-hidden="true" tabindex="-1"></a>  <span class="co"># .bat file</span></span>
<span id="cb25-108"><a href="#cb25-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(</span>
<span id="cb25-109"><a href="#cb25-109" aria-hidden="true" tabindex="-1"></a>    <span class="st">'C:/Winsteps/Winsteps.exe   BATCH=YES "overall_control.ctr" '</span></span>
<span id="cb25-110"><a href="#cb25-110" aria-hidden="true" tabindex="-1"></a>    , <span class="st">'"OUT.csv" HLINES=YES'</span></span>
<span id="cb25-111"><a href="#cb25-111" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb25-112"><a href="#cb25-112" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write_lines</span>(<span class="st">'temp/winsteps_overall.bat'</span>)</span>
<span id="cb25-113"><a href="#cb25-113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-114"><a href="#cb25-114" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run .bat</span></span>
<span id="cb25-115"><a href="#cb25-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system</span>(<span class="st">"cmd.exe"</span>,</span>
<span id="cb25-116"><a href="#cb25-116" aria-hidden="true" tabindex="-1"></a>         <span class="at">input =</span> <span class="fu">paste</span>(<span class="st">' cd temp/ &amp; winsteps_overall.bat'</span>),</span>
<span id="cb25-117"><a href="#cb25-117" aria-hidden="true" tabindex="-1"></a>         <span class="at">show.output.on.console =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-118"><a href="#cb25-118" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-119"><a href="#cb25-119" aria-hidden="true" tabindex="-1"></a>winsteps_read_scores <span class="ot">=</span> <span class="cf">function</span>(<span class="at">scores_file =</span> <span class="st">'theta.out'</span>) {</span>
<span id="cb25-120"><a href="#cb25-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(tidyverse)</span>
<span id="cb25-121"><a href="#cb25-121" aria-hidden="true" tabindex="-1"></a>  overall_scores <span class="ot">&lt;-</span></span>
<span id="cb25-122"><a href="#cb25-122" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_table</span>(<span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">'temp/'</span>, scores_file)</span>
<span id="cb25-123"><a href="#cb25-123" aria-hidden="true" tabindex="-1"></a>               , <span class="at">show_col_types =</span> <span class="cn">FALSE</span></span>
<span id="cb25-124"><a href="#cb25-124" aria-hidden="true" tabindex="-1"></a>               , <span class="at">skip =</span> <span class="dv">1</span>) </span>
<span id="cb25-125"><a href="#cb25-125" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(overall_scores) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb25-126"><a href="#cb25-126" aria-hidden="true" tabindex="-1"></a>    overall_scores <span class="ot">&lt;-</span></span>
<span id="cb25-127"><a href="#cb25-127" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tibble</span>(</span>
<span id="cb25-128"><a href="#cb25-128" aria-hidden="true" tabindex="-1"></a>        <span class="at">RegID =</span> <span class="cn">NA</span>, <span class="at">winsteps_answered =</span> <span class="cn">NA</span>, <span class="at">winsteps_number_correct =</span> <span class="cn">NA</span></span>
<span id="cb25-129"><a href="#cb25-129" aria-hidden="true" tabindex="-1"></a>        , <span class="at">winsteps_estimate =</span> <span class="cn">NA</span>, <span class="at">Exam =</span> exam</span>
<span id="cb25-130"><a href="#cb25-130" aria-hidden="true" tabindex="-1"></a>        , <span class="at">winsteps_score =</span> <span class="cn">NA</span></span>
<span id="cb25-131"><a href="#cb25-131" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb25-132"><a href="#cb25-132" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb25-133"><a href="#cb25-133" aria-hidden="true" tabindex="-1"></a>      overall_scores <span class="ot">&lt;-</span></span>
<span id="cb25-134"><a href="#cb25-134" aria-hidden="true" tabindex="-1"></a>        overall_scores <span class="sc">%&gt;%</span></span>
<span id="cb25-135"><a href="#cb25-135" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(MEASURE) <span class="sc">%&gt;%</span></span>
<span id="cb25-136"><a href="#cb25-136" aria-hidden="true" tabindex="-1"></a>        <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-137"><a href="#cb25-137" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.numeric</span>()</span>
<span id="cb25-138"><a href="#cb25-138" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb25-139"><a href="#cb25-139" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(overall_scores)</span>
<span id="cb25-140"><a href="#cb25-140" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-141"><a href="#cb25-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-142"><a href="#cb25-142" aria-hidden="true" tabindex="-1"></a><span class="co"># options('warn' = 2)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, for each condition, we create the simulated item and person parameters and use the different estimation methods to estimate the person parameters based on the simulated data.</p>
<p>For PROX, a custom function using the formula <a href="https://www.winsteps.com/winman/iterations.htm">given on the Winsteps website</a> was implemented.</p>
<p>For JMLE, the <code>tam.jml</code> function accepts the matrix of responses and, optionally, a matrix of item numbers (first column) and item difficulties (second column) to use as fixed values. This puts the focus on the <em>person parameter estimates</em> which is what we want for our simulation. The <code>$theta</code> element of the resulting list holds the estimated person parameters. Since the function does not automatically remove items with no correct responses, the simulation automatically removes these items (if they exist in the given iteration) and estimates person parameters based on the remaining items.</p>
<!-- For MMLE, the `tam.mml` function behaves similarly. The output is different, however; we need to access `$person$EAP` to get the person theta estimates using the expected a posteriori of the marginal maximum likelihood estimator. Since some items may normally be removed due to the number of correct responses, we also specify `item.elim = FALSE` to keep these items in the analysis. -->
<!-- I forgot to actually include the mml EAP estimates in the final results, d'oh! -->
<p>For CMLE, the Winsteps software is used. A custom function that manages the Winsteps control files and reads in the results was created as a simpler and more programmatic interface between the simulation conditions and Winsteps. With fixed item parameters, Winsteps is able to generate person parameters with CMLE; other common Rasch/IRT software does not seem to have this functionality.</p>

<!-- For CMLE, the `eRm::RM` function takes the scored matrix and estimates the full model (item and person parameters) "simultaneously", so we can't provide the known item difficulties for this procedure. We also need to extract the person theta estimates with the `eRm::person.parameter` function, accessing the stored estimates in the output with `$theta.table$'Person Parameter'`. This does mean the CMLE estimates are not strictly comparable and may have additional estimation discrepancies. As the `eRm` package sometimes has issues with all correct/all incorrect response patterns, there is a wrapper function implemented that removes problematic items from the scored matrix when `eRm` throws an error and reruns the estimation process. -->
<p>For EAP, the <code>irtoys</code> package provides an <code>eap()</code> estimator in the <code>ability()</code> function that can utilize the known item parameters. The first column of resulting matrix provides the ability estimates for each provided response pattern in the scoring matrix. Under the hood, it uses the <code>ltm</code> package by default.</p>
<section id="standard-normal" class="level3">
<h3 class="anchored" data-anchor-id="standard-normal">Standard Normal</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conditions 1-18 Parameters</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>Start.time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>m_item <span class="ot">=</span> m_person <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>sd_item <span class="ot">=</span> sd_person <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>estimates_file_name <span class="ot">=</span> <span class="st">'simdata/01_standard_normal_estimates.RDS'</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>responses_file_name <span class="ot">=</span> <span class="st">'simdata/01_standard_normal_responses.RDS'</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>condition_1_estimates <span class="ot">=</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">'list'</span>, <span class="at">length =</span> <span class="dv">18</span><span class="sc">*</span>iter)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>condition_1_responses <span class="ot">=</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">'list'</span>, <span class="at">length =</span> <span class="dv">18</span><span class="sc">*</span>iter)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>offset <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> number_items) {</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Items: "</span>, j))</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> person_sample_sizes) {</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Persons: "</span>, n))</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    offset <span class="ot">=</span> offset <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    condition_name <span class="ot">=</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tibble</span>(</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">Title =</span> <span class="st">"Standard Normal"</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>        , <span class="at">ItemMean =</span> m_item, <span class="at">ItemSD =</span> sd_item</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>        , <span class="at">PersonMean =</span> m_person, <span class="at">PersonSD =</span> sd_person</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>        , <span class="at">N_Items =</span> j</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>        , <span class="at">N_Person =</span> n</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iter) {</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>      item_diff <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> j, <span class="at">mean =</span> m_item, <span class="at">sd =</span> sd_item), <span class="dv">3</span>)</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>      person_theta <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> m_person, <span class="at">sd =</span> sd_person)</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>      responses <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n, <span class="at">ncol =</span> j)</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>        responses[p,] <span class="ot">=</span> <span class="fu">rasch_response_sim</span>(person_theta[p], item_diff)</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>      zero_correct_items <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">colSums</span>(responses) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">colSums</span>(responses) <span class="sc">==</span> n)</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">length</span>(zero_correct_items) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>        modified_responses <span class="ot">=</span> responses[, <span class="sc">-</span>zero_correct_items]</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>        modified_item_diff <span class="ot">=</span> item_diff[<span class="sc">-</span>zero_correct_items]</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>        winsteps_item_diff <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">IRTb =</span> modified_item_diff) <span class="sc">%&gt;%</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">ItemID =</span> <span class="fu">paste0</span>(<span class="st">"V"</span>, <span class="fu">row_number</span>()))</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>        modified_responses <span class="ot">=</span> responses</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>        modified_item_diff <span class="ot">=</span> item_diff</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>        winsteps_item_diff <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">IRTb =</span> modified_item_diff) <span class="sc">%&gt;%</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">ItemID =</span> <span class="fu">paste0</span>(<span class="st">"V"</span>, <span class="fu">row_number</span>()))</span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>      prox_theta_est <span class="ot">=</span> <span class="fu">prox_estimate</span>(<span class="at">mean_item_diff =</span> <span class="fu">mean</span>(item_diff),</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">sd_item_diff =</span> <span class="fu">sd</span>(item_diff),</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">observed_raw_score =</span> <span class="fu">rowSums</span>(responses),</span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">maximum_score =</span> j)</span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>      jmle_theta_est <span class="ot">=</span> TAM<span class="sc">::</span><span class="fu">tam.jml</span>(</span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>        modified_responses</span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>        , <span class="at">xsi.fixed =</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(modified_item_diff), modified_item_diff)</span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>        , <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>      )<span class="sc">$</span>theta</span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>      mmle_theta_est <span class="ot">=</span> TAM<span class="sc">::</span><span class="fu">tam.mml</span>(</span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>        modified_responses,</span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">xsi.fixed =</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(modified_item_diff), modified_item_diff),</span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">item.elim =</span> <span class="cn">FALSE</span>,</span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>      )<span class="sc">$</span>person<span class="sc">$</span>EAP</span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a>      modified_responses <span class="sc">%&gt;%</span></span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a>          <span class="at">id =</span> <span class="fu">paste0</span>(<span class="st">'00000'</span>, <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> <span class="fu">str_sub</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a>          , <span class="at">.before =</span> <span class="dv">1</span></span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span></span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a>        <span class="fu">pivot_longer</span>(</span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a>          <span class="at">cols =</span> <span class="sc">-</span>id</span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a>          , <span class="at">names_to =</span> <span class="st">'item'</span></span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a>          , <span class="at">values_to =</span> <span class="st">'response'</span></span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span></span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a>        <span class="fu">winsteps_estimate</span>(</span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> .</span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a>          , <span class="at">item_params =</span> winsteps_item_diff</span>
<span id="cb26-80"><a href="#cb26-80" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb26-81"><a href="#cb26-81" aria-hidden="true" tabindex="-1"></a>      cmle_theta_est <span class="ot">=</span> <span class="fu">winsteps_read_scores</span>()</span>
<span id="cb26-82"><a href="#cb26-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-83"><a href="#cb26-83" aria-hidden="true" tabindex="-1"></a>      eap_theta_est  <span class="ot">=</span></span>
<span id="cb26-84"><a href="#cb26-84" aria-hidden="true" tabindex="-1"></a>        irtoys<span class="sc">::</span><span class="fu">ability</span>(<span class="at">resp =</span> modified_responses,</span>
<span id="cb26-85"><a href="#cb26-85" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ip =</span> <span class="fu">list</span>(<span class="st">'est'</span> <span class="ot">=</span> <span class="fu">cbind</span>(</span>
<span id="cb26-86"><a href="#cb26-86" aria-hidden="true" tabindex="-1"></a>                          <span class="dv">1</span>, modified_item_diff, <span class="dv">0</span>, <span class="at">deparse.level =</span> <span class="dv">0</span></span>
<span id="cb26-87"><a href="#cb26-87" aria-hidden="true" tabindex="-1"></a>                        )),</span>
<span id="cb26-88"><a href="#cb26-88" aria-hidden="true" tabindex="-1"></a>                        <span class="at">method =</span> <span class="st">'EAP'</span>)[, <span class="dv">1</span>]</span>
<span id="cb26-89"><a href="#cb26-89" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb26-90"><a href="#cb26-90" aria-hidden="true" tabindex="-1"></a>      thetas <span class="ot">=</span> <span class="fu">cbind</span>(person_theta,</span>
<span id="cb26-91"><a href="#cb26-91" aria-hidden="true" tabindex="-1"></a>                     prox_theta_est,</span>
<span id="cb26-92"><a href="#cb26-92" aria-hidden="true" tabindex="-1"></a>                     jmle_theta_est,</span>
<span id="cb26-93"><a href="#cb26-93" aria-hidden="true" tabindex="-1"></a>                     cmle_theta_est,</span>
<span id="cb26-94"><a href="#cb26-94" aria-hidden="true" tabindex="-1"></a>                     eap_theta_est)</span>
<span id="cb26-95"><a href="#cb26-95" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb26-96"><a href="#cb26-96" aria-hidden="true" tabindex="-1"></a>      condition_1_estimates[[i<span class="sc">+</span>offset]] <span class="ot">=</span> <span class="fu">list</span>(<span class="at">Condition =</span> condition_name, <span class="at">Theta =</span> thetas)</span>
<span id="cb26-97"><a href="#cb26-97" aria-hidden="true" tabindex="-1"></a>      condition_1_responses[[i<span class="sc">+</span>offset]] <span class="ot">=</span> <span class="fu">list</span>(<span class="at">Condition =</span> condition_name, <span class="at">ItemDiff =</span> item_diff, <span class="at">Responses =</span> responses)</span>
<span id="cb26-98"><a href="#cb26-98" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb26-99"><a href="#cb26-99" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-100"><a href="#cb26-100" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-101"><a href="#cb26-101" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-102"><a href="#cb26-102" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-103"><a href="#cb26-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-104"><a href="#cb26-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-105"><a href="#cb26-105" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(condition_1_estimates, <span class="at">file =</span> estimates_file_name)</span>
<span id="cb26-106"><a href="#cb26-106" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(condition_1_responses, <span class="at">file =</span> responses_file_name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>59.881215886275</p>
</section>
<section id="wide-normal" class="level3">
<h3 class="anchored" data-anchor-id="wide-normal">Wide Normal</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Condition 7 Parameters</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>Start.time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>n_person <span class="ot">=</span> person_sample_sizes[<span class="dv">1</span>]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>n_item <span class="ot">=</span> <span class="dv">200</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>m_item <span class="ot">=</span> m_person <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>sd_item <span class="ot">=</span> sd_person <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>estimates_file_name <span class="ot">=</span> <span class="st">'simdata/condition_7_estimates.RDS'</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>responses_file_name <span class="ot">=</span> <span class="st">'simdata/condition_7_responses.RDS'</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>condition_7_estimates <span class="ot">=</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">'list'</span>, <span class="at">length =</span> iter)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>condition_7_responses <span class="ot">=</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">'list'</span>, <span class="at">length =</span> iter)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iter) {</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  item_diff <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> n_item, <span class="at">mean =</span> m_item, <span class="at">sd =</span> sd_item), <span class="dv">3</span>)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  person_theta <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n_person, <span class="at">mean =</span> m_person, <span class="at">sd =</span> sd_person)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  responses <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n_person, <span class="at">ncol =</span> n_item)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_person) {</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    responses[p, ] <span class="ot">=</span> <span class="fu">rasch_response_sim</span>(person_theta[p], item_diff)</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>  zero_correct_items <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">colSums</span>(responses) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">colSums</span>(responses) <span class="sc">==</span> n_person)</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(zero_correct_items) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>    modified_responses <span class="ot">=</span> responses[,<span class="sc">-</span>zero_correct_items]</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    modified_item_diff <span class="ot">=</span> item_diff[<span class="sc">-</span>zero_correct_items]</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    modified_responses <span class="ot">=</span> responses</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>    modified_item_diff <span class="ot">=</span> item_diff</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>  prox_theta_est <span class="ot">=</span> <span class="fu">prox_estimate</span>(<span class="fu">mean</span>(item_diff), <span class="fu">sd</span>(item_diff), <span class="fu">rowSums</span>(responses), n_item)</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>  jmle_theta_est <span class="ot">=</span> TAM<span class="sc">::</span><span class="fu">tam.jml</span>(modified_responses, <span class="at">xsi.fixed =</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(modified_item_diff), modified_item_diff), <span class="at">verbose =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>theta</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>  mmle_theta_est <span class="ot">=</span> TAM<span class="sc">::</span><span class="fu">tam.mml</span>(modified_responses, <span class="at">xsi.fixed =</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(modified_item_diff), modified_item_diff), <span class="at">item.elim =</span> <span class="cn">FALSE</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>person<span class="sc">$</span>EAP</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>  cmle_theta_est <span class="ot">=</span> <span class="fu">eRm_person_estimate</span>(modified_responses)</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>  eap_theta_est  <span class="ot">=</span> </span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>    irtoys<span class="sc">::</span><span class="fu">ability</span>(</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">resp =</span> modified_responses,</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">ip =</span> <span class="fu">list</span>(<span class="st">'est'</span> <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, modified_item_diff, <span class="dv">0</span>, <span class="at">deparse.level =</span> <span class="dv">0</span>)),</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">'EAP'</span></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>    )[,<span class="dv">1</span>]</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>  thetas <span class="ot">=</span> <span class="fu">cbind</span>(person_theta, prox_theta_est, jmle_theta_est, cmle_theta_est, eap_theta_est)</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>  condition_7_estimates[[i]] <span class="ot">=</span> thetas</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>  condition_7_responses[[i]] <span class="ot">=</span> <span class="fu">list</span>(item_diff, responses)</span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(condition_7_estimates, <span class="at">file =</span> estimates_file_name)</span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(condition_7_responses, <span class="at">file =</span> responses_file_name)</span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> Start.time</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="item-1-theta" class="level3">
<h3 class="anchored" data-anchor-id="item-1-theta">-1 Item +1 Theta</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Condition 13 Parameters</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>Start.time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>n_person <span class="ot">=</span> person_sample_sizes[<span class="dv">1</span>]</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>n_item <span class="ot">=</span> <span class="dv">200</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>m_item <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span>; m_person <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>sd_item <span class="ot">=</span> sd_person <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>estimates_file_name <span class="ot">=</span> <span class="st">'simdata/condition_13_estimates.RDS'</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>responses_file_name <span class="ot">=</span> <span class="st">'simdata/condition_13_responses.RDS'</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>condition_13_estimates <span class="ot">=</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">'list'</span>, <span class="at">length =</span> iter)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>condition_13_responses <span class="ot">=</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">'list'</span>, <span class="at">length =</span> iter)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iter) {</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  item_diff <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> n_item, <span class="at">mean =</span> m_item, <span class="at">sd =</span> sd_item), <span class="dv">3</span>)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  person_theta <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n_person, <span class="at">mean =</span> m_person, <span class="at">sd =</span> sd_person)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  responses <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n_person, <span class="at">ncol =</span> n_item)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_person) {</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    responses[p, ] <span class="ot">=</span> <span class="fu">rasch_response_sim</span>(person_theta[p], item_diff)</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>  zero_correct_items <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">colSums</span>(responses) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">colSums</span>(responses) <span class="sc">==</span> n_person)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(zero_correct_items) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    modified_responses <span class="ot">=</span> responses[,<span class="sc">-</span>zero_correct_items]</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    modified_item_diff <span class="ot">=</span> item_diff[<span class="sc">-</span>zero_correct_items]</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    modified_responses <span class="ot">=</span> responses</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>    modified_item_diff <span class="ot">=</span> item_diff</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>  prox_theta_est <span class="ot">=</span> <span class="fu">prox_estimate</span>(<span class="fu">mean</span>(item_diff), <span class="fu">sd</span>(item_diff), <span class="fu">rowSums</span>(responses), n_item)</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>  jmle_theta_est <span class="ot">=</span> TAM<span class="sc">::</span><span class="fu">tam.jml</span>(modified_responses, <span class="at">xsi.fixed =</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(modified_item_diff), modified_item_diff), <span class="at">verbose =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>theta</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>  mmle_theta_est <span class="ot">=</span> TAM<span class="sc">::</span><span class="fu">tam.mml</span>(modified_responses, <span class="at">xsi.fixed =</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(modified_item_diff), modified_item_diff), <span class="at">item.elim =</span> <span class="cn">FALSE</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>person<span class="sc">$</span>EAP</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>  cmle_theta_est <span class="ot">=</span> <span class="fu">eRm_person_estimate</span>(modified_responses)</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>  eap_theta_est  <span class="ot">=</span> </span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>    irtoys<span class="sc">::</span><span class="fu">ability</span>(</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">resp =</span> modified_responses,</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">ip =</span> <span class="fu">list</span>(<span class="st">'est'</span> <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, modified_item_diff, <span class="dv">0</span>, <span class="at">deparse.level =</span> <span class="dv">0</span>)),</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">'EAP'</span></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>    )[,<span class="dv">1</span>]</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>  thetas <span class="ot">=</span> <span class="fu">cbind</span>(person_theta, prox_theta_est, jmle_theta_est, cmle_theta_est, eap_theta_est)</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>  condition_13_estimates[[i]] <span class="ot">=</span> thetas</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>  condition_13_responses[[i]] <span class="ot">=</span> <span class="fu">list</span>(item_diff, responses)</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(condition_13_estimates, <span class="at">file =</span> estimates_file_name)</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(condition_13_responses, <span class="at">file =</span> responses_file_name)</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> Start.time</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="item-2-theta" class="level3">
<h3 class="anchored" data-anchor-id="item-2-theta">-2 Item +2 Theta</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Condition 19 Parameters</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>Start.time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>n_person <span class="ot">=</span> person_sample_sizes[<span class="dv">1</span>]</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>n_item <span class="ot">=</span> <span class="dv">200</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>m_item <span class="ot">=</span> <span class="sc">-</span><span class="dv">2</span>; m_person <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>sd_item <span class="ot">=</span> sd_person <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>estimates_file_name <span class="ot">=</span> <span class="st">'simdata/condition_19_estimates.RDS'</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>responses_file_name <span class="ot">=</span> <span class="st">'simdata/condition_19_responses.RDS'</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>condition_19_estimates <span class="ot">=</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">'list'</span>, <span class="at">length =</span> iter)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>condition_19_responses <span class="ot">=</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">'list'</span>, <span class="at">length =</span> iter)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iter) {</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  item_diff <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> n_item, <span class="at">mean =</span> m_item, <span class="at">sd =</span> sd_item), <span class="dv">3</span>)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  person_theta <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n_person, <span class="at">mean =</span> m_person, <span class="at">sd =</span> sd_person)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  responses <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n_person, <span class="at">ncol =</span> n_item)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_person) {</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>    responses[p, ] <span class="ot">=</span> <span class="fu">rasch_response_sim</span>(person_theta[p], item_diff)</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>  zero_correct_items <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">colSums</span>(responses) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">colSums</span>(responses) <span class="sc">==</span> n_person)</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(zero_correct_items) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    modified_responses <span class="ot">=</span> responses[,<span class="sc">-</span>zero_correct_items]</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    modified_item_diff <span class="ot">=</span> item_diff[<span class="sc">-</span>zero_correct_items]</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>    modified_responses <span class="ot">=</span> responses</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>    modified_item_diff <span class="ot">=</span> item_diff</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>  prox_theta_est <span class="ot">=</span> <span class="fu">prox_estimate</span>(<span class="fu">mean</span>(item_diff), <span class="fu">sd</span>(item_diff), <span class="fu">rowSums</span>(responses), n_item)</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>  jmle_theta_est <span class="ot">=</span> TAM<span class="sc">::</span><span class="fu">tam.jml</span>(modified_responses, <span class="at">xsi.fixed =</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(modified_item_diff), modified_item_diff), <span class="at">verbose =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>theta</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>  mmle_theta_est <span class="ot">=</span> TAM<span class="sc">::</span><span class="fu">tam.mml</span>(modified_responses, <span class="at">xsi.fixed =</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(modified_item_diff), modified_item_diff), <span class="at">item.elim =</span> <span class="cn">FALSE</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>person<span class="sc">$</span>EAP</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>  cmle_theta_est <span class="ot">=</span> <span class="fu">eRm_person_estimate</span>(modified_responses)</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>  eap_theta_est  <span class="ot">=</span> </span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>    irtoys<span class="sc">::</span><span class="fu">ability</span>(</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">resp =</span> modified_responses,</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">ip =</span> <span class="fu">list</span>(<span class="st">'est'</span> <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, modified_item_diff, <span class="dv">0</span>, <span class="at">deparse.level =</span> <span class="dv">0</span>)),</span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">'EAP'</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>    )[,<span class="dv">1</span>]</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>  thetas <span class="ot">=</span> <span class="fu">cbind</span>(person_theta, prox_theta_est, jmle_theta_est, cmle_theta_est, eap_theta_est)</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>  condition_19_estimates[[i]] <span class="ot">=</span> thetas</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>  condition_19_responses[[i]] <span class="ot">=</span> <span class="fu">list</span>(item_diff, responses)</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(condition_19_estimates, <span class="at">file =</span> estimates_file_name)</span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(condition_19_responses, <span class="at">file =</span> responses_file_name)</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> Start.time</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="item-3-theta" class="level3">
<h3 class="anchored" data-anchor-id="item-3-theta">-3 Item +3 Theta</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Condition 25 Parameters</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>Start.time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>Start.time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>n_person <span class="ot">=</span> person_sample_sizes[<span class="dv">1</span>]</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>n_item <span class="ot">=</span> <span class="dv">200</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>m_item <span class="ot">=</span> <span class="sc">-</span><span class="dv">3</span>; m_person <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>sd_item <span class="ot">=</span> sd_person <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>estimates_file_name <span class="ot">=</span> <span class="st">'simdata/condition_25_estimates.RDS'</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>responses_file_name <span class="ot">=</span> <span class="st">'simdata/condition_25_responses.RDS'</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>condition_25_estimates <span class="ot">=</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">'list'</span>, <span class="at">length =</span> iter)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>condition_25_responses <span class="ot">=</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">'list'</span>, <span class="at">length =</span> iter)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iter) {</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  item_diff <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> n_item, <span class="at">mean =</span> m_item, <span class="at">sd =</span> sd_item), <span class="dv">3</span>)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  person_theta <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n_person, <span class="at">mean =</span> m_person, <span class="at">sd =</span> sd_person)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  responses <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n_person, <span class="at">ncol =</span> n_item)</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_person) {</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    responses[p, ] <span class="ot">=</span> <span class="fu">rasch_response_sim</span>(person_theta[p], item_diff)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>  zero_correct_items <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">colSums</span>(responses) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">colSums</span>(responses) <span class="sc">==</span> n_person)</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(zero_correct_items) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    modified_responses <span class="ot">=</span> responses[,<span class="sc">-</span>zero_correct_items]</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    modified_item_diff <span class="ot">=</span> item_diff[<span class="sc">-</span>zero_correct_items]</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>    modified_responses <span class="ot">=</span> responses</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>    modified_item_diff <span class="ot">=</span> item_diff</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>  prox_theta_est <span class="ot">=</span> <span class="fu">prox_estimate</span>(<span class="fu">mean</span>(item_diff), <span class="fu">sd</span>(item_diff), <span class="fu">rowSums</span>(responses), n_item)</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>  jmle_theta_est <span class="ot">=</span> TAM<span class="sc">::</span><span class="fu">tam.jml</span>(modified_responses, <span class="at">xsi.fixed =</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(modified_item_diff), modified_item_diff), <span class="at">verbose =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>theta</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>  mmle_theta_est <span class="ot">=</span> TAM<span class="sc">::</span><span class="fu">tam.mml</span>(modified_responses, <span class="at">xsi.fixed =</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(modified_item_diff), modified_item_diff), <span class="at">item.elim =</span> <span class="cn">FALSE</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>person<span class="sc">$</span>EAP</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>  cmle_theta_est <span class="ot">=</span> <span class="fu">eRm_person_estimate</span>(modified_responses)</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>  eap_theta_est  <span class="ot">=</span> </span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>    irtoys<span class="sc">::</span><span class="fu">ability</span>(</span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">resp =</span> modified_responses,</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">ip =</span> <span class="fu">list</span>(<span class="st">'est'</span> <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, modified_item_diff, <span class="dv">0</span>, <span class="at">deparse.level =</span> <span class="dv">0</span>)),</span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">'EAP'</span></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>    )[,<span class="dv">1</span>]</span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>  thetas <span class="ot">=</span> <span class="fu">cbind</span>(person_theta, prox_theta_est, jmle_theta_est, cmle_theta_est, eap_theta_est)</span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>  condition_25_estimates[[i]] <span class="ot">=</span> thetas</span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>  condition_25_responses[[i]] <span class="ot">=</span> <span class="fu">list</span>(item_diff, responses)</span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(condition_25_estimates, <span class="at">file =</span> estimates_file_name)</span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(condition_25_responses, <span class="at">file =</span> responses_file_name)</span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> Start.time</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="normal-item-bimodal-theta" class="level3">
<h3 class="anchored" data-anchor-id="normal-item-bimodal-theta">Normal Item, Bimodal Theta</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Condition 31 Parameters</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>Start.time <span class="ot">=</span> <span class="fu">Sys.time</span>()</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>n_person <span class="ot">=</span> person_sample_sizes[<span class="dv">1</span>]</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>n_item <span class="ot">=</span> <span class="dv">200</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>m_item <span class="ot">=</span> <span class="dv">0</span>; m_person <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>sd_item <span class="ot">=</span> sd_person <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>estimates_file_name <span class="ot">=</span> <span class="st">'simdata/condition_31_estimates.RDS'</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>responses_file_name <span class="ot">=</span> <span class="st">'simdata/condition_31_responses.RDS'</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>condition_31_estimates <span class="ot">=</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">'list'</span>, <span class="at">length =</span> iter)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>condition_31_responses <span class="ot">=</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">'list'</span>, <span class="at">length =</span> iter)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iter) {</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  item_diff <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> n_item, <span class="at">mean =</span> m_item, <span class="at">sd =</span> sd_item), <span class="dv">3</span>)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  person_theta <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n_person, <span class="at">mean =</span> m_person, <span class="at">sd =</span> sd_person)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  responses <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n_person, <span class="at">ncol =</span> n_item)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_person) {</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    responses[p, ] <span class="ot">=</span> <span class="fu">rasch_response_sim</span>(person_theta[p], item_diff)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  zero_correct_items <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">colSums</span>(responses) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">colSums</span>(responses) <span class="sc">==</span> n_person)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(zero_correct_items) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    modified_responses <span class="ot">=</span> responses[,<span class="sc">-</span>zero_correct_items]</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    modified_item_diff <span class="ot">=</span> item_diff[<span class="sc">-</span>zero_correct_items]</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>    modified_responses <span class="ot">=</span> responses</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>    modified_item_diff <span class="ot">=</span> item_diff</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>  prox_theta_est <span class="ot">=</span> <span class="fu">prox_estimate</span>(<span class="fu">mean</span>(item_diff), <span class="fu">sd</span>(item_diff), <span class="fu">rowSums</span>(responses), n_item)</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>  jmle_theta_est <span class="ot">=</span> TAM<span class="sc">::</span><span class="fu">tam.jml</span>(modified_responses, <span class="at">xsi.fixed =</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(modified_item_diff), modified_item_diff), <span class="at">verbose =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>theta</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>  mmle_theta_est <span class="ot">=</span> TAM<span class="sc">::</span><span class="fu">tam.mml</span>(modified_responses, <span class="at">xsi.fixed =</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(modified_item_diff), modified_item_diff), <span class="at">item.elim =</span> <span class="cn">FALSE</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>person<span class="sc">$</span>EAP</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>  cmle_theta_est <span class="ot">=</span> <span class="fu">eRm_person_estimate</span>(modified_responses)</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>  eap_theta_est  <span class="ot">=</span> </span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>    irtoys<span class="sc">::</span><span class="fu">ability</span>(</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">resp =</span> modified_responses,</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">ip =</span> <span class="fu">list</span>(<span class="st">'est'</span> <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, modified_item_diff, <span class="dv">0</span>, <span class="at">deparse.level =</span> <span class="dv">0</span>)),</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">'EAP'</span></span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>    )[,<span class="dv">1</span>]</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>  thetas <span class="ot">=</span> <span class="fu">cbind</span>(person_theta, prox_theta_est, jmle_theta_est, cmle_theta_est, eap_theta_est)</span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>  condition_31_estimates[[i]] <span class="ot">=</span> thetas</span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>  condition_31_responses[[i]] <span class="ot">=</span> <span class="fu">list</span>(item_diff, responses)</span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(condition_31_estimates, <span class="at">file =</span> estimates_file_name)</span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(condition_31_responses, <span class="at">file =</span> responses_file_name)</span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">-</span> Start.time</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bimodal-item-normal-theta" class="level3">
<h3 class="anchored" data-anchor-id="bimodal-item-normal-theta">Bimodal Item, Normal Theta</h3>
</section>
</section>
<section id="analyzing-the-data" class="level2">
<h2 class="anchored" data-anchor-id="analyzing-the-data">Analyzing the data</h2>
<p>“Point-Estimate” methods to analyze the data:</p>
<ol type="1">
<li>Correlation between true and estimated theta</li>
<li>(Mean) Bias</li>
<li>Mean Absolute Difference</li>
<li>Mean Square Error</li>
<li>Root Mean Square Error</li>
</ol>
<p>done for each iteration of each condition. Then, these estimates can be averaged and a standard error of each measure calculated.</p>
<p>Using the “point estimate” for each condition as the DV, an ANOVA/LR can be used with the condition variables as IVs.</p>
</section>
<section id="correlation" class="level2">
<h2 class="anchored" data-anchor-id="correlation">Correlation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mean_corr_list <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Reduce</span>(<span class="st">"+"</span>, x) <span class="sc">/</span> <span class="fu">length</span>(x)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>estimates_files_list <span class="ot">&lt;-</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">'simdata/'</span>, conditions<span class="sc">$</span>filename)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># short_file &lt;-</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   list.files('simdata/', pattern = 'estimates')</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>loaded_estimates <span class="ot">&lt;-</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">readRDS</span>(estimates_files_list[<span class="dv">1</span>])</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>mean_correlation <span class="ot">&lt;-</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  loaded_estimates <span class="sc">%&gt;%</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(<span class="st">'thetas'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(cor) <span class="sc">%&gt;%</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_corr_list</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Condition =</span> conditions<span class="sc">$</span>Condition[<span class="dv">1</span>], <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Estimate =</span> <span class="fu">c</span>(<span class="st">"person_theta"</span>, <span class="st">"prox_theta_est"</span>, <span class="st">"jmle_theta_est"</span>, <span class="st">"cmle_theta_est"</span>, <span class="st">"eap_theat_est"</span>), <span class="at">.after =</span> <span class="dv">1</span>) </span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(estimates_files_list)) {</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  loaded_estimates <span class="ot">&lt;-</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">readRDS</span>(estimates_files_list[i])</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>(</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>      loaded_estimates <span class="sc">%&gt;%</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>        purrr<span class="sc">::</span><span class="fu">map</span>(<span class="st">'thetas'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>        purrr<span class="sc">::</span><span class="fu">map</span>(as_tibble) <span class="sc">%&gt;%</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>        purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">mutate_all</span>(<span class="sc">~</span> <span class="fu">case_when</span>((. <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span>)<span class="sc">|</span>(<span class="fu">is.na</span>(.) <span class="sc">&amp;</span> (<span class="fu">sign</span>(person_theta) <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>)) <span class="sc">~</span> <span class="sc">-</span><span class="dv">4</span>, (. <span class="sc">==</span> <span class="cn">Inf</span>)<span class="sc">|</span>(<span class="fu">is.na</span>(.) <span class="sc">&amp;</span> (<span class="fu">sign</span>(person_theta) <span class="sc">==</span> <span class="dv">1</span>)) <span class="sc">~</span> <span class="dv">4</span>, <span class="cn">TRUE</span> <span class="sc">~</span> .))) <span class="sc">%&gt;%</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>        purrr<span class="sc">::</span><span class="fu">map</span>(cor) <span class="sc">%&gt;%</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mean_corr_list</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">Condition =</span> conditions<span class="sc">$</span>Condition[i], <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">Estimate =</span> <span class="fu">c</span>(<span class="st">"person_theta"</span>, <span class="st">"prox_theta_est"</span>, <span class="st">"jmle_theta_est"</span>, <span class="st">"cmle_theta_est"</span>, <span class="st">"eap_theat_est"</span>), <span class="at">.after =</span> <span class="dv">1</span>)</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">error =</span> <span class="cf">function</span>(e)</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>        <span class="st">'error'</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">'tbl'</span> <span class="sc">%in%</span> <span class="fu">class</span>(test)) {</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>    mean_correlation <span class="ot">&lt;-</span></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>      mean_correlation <span class="sc">%&gt;%</span></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_rows</span>(</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>        test</span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (test <span class="sc">==</span> <span class="st">'error'</span>) {</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>    mean_correlation <span class="ot">&lt;-</span></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>      mean_correlation <span class="sc">%&gt;%</span></span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_rows</span>(</span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>        loaded_estimates <span class="sc">%&gt;%</span></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">map</span>(as_tibble) <span class="sc">%&gt;%</span></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span>.x <span class="sc">%&gt;%</span> <span class="fu">mutate_all</span>(<span class="sc">~</span> <span class="fu">case_when</span>((. <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span>)<span class="sc">|</span>(<span class="fu">is.na</span>(.) <span class="sc">&amp;</span> (<span class="fu">sign</span>(person_theta) <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>)) <span class="sc">~</span> <span class="sc">-</span><span class="dv">4</span>, (. <span class="sc">==</span> <span class="cn">Inf</span>)<span class="sc">|</span>(<span class="fu">is.na</span>(.) <span class="sc">&amp;</span> (<span class="fu">sign</span>(person_theta) <span class="sc">==</span> <span class="dv">1</span>)) <span class="sc">~</span> <span class="dv">4</span>, <span class="cn">TRUE</span> <span class="sc">~</span> .))) <span class="sc">%&gt;%</span></span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">map</span>(cor) <span class="sc">%&gt;%</span></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mean_corr_list</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>          <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">Condition =</span> conditions<span class="sc">$</span>Condition[i], <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">Estimate =</span> <span class="fu">c</span>(<span class="st">"person_theta"</span>, <span class="st">"prox_theta_est"</span>, <span class="st">"jmle_theta_est"</span>, <span class="st">"cmle_theta_est"</span>, <span class="st">"eap_theat_est"</span>), <span class="at">.after =</span> <span class="dv">1</span>)</span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Something went wrong."</span>)</span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a>mean_correlation <span class="sc">%&gt;%</span></span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>person_theta) <span class="sc">%&gt;%</span></span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">'results/00_mean_correlation.RDS'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="point-estimate" class="level2">
<h2 class="anchored" data-anchor-id="point-estimate">“Point-Estimate”</h2>
<section id="point-estimate-functions" class="level3">
<h3 class="anchored" data-anchor-id="point-estimate-functions">“Point-Estimate” functions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>bias_estimator <span class="ot">=</span> <span class="cf">function</span>(data) {</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  true_theta <span class="ot">=</span> data[,<span class="dv">1</span>]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  bias <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    data <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">prox_theta_est =</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">case_when</span>(</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>          prox_theta_est <span class="sc">==</span> <span class="cn">Inf</span> <span class="sc">|</span> prox_theta_est <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">4</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>          , prox_theta_est <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span> <span class="sc">|</span> prox_theta_est <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">4</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>          , <span class="cn">TRUE</span> <span class="sc">~</span> prox_theta_est</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>      , <span class="at">cmle_theta_est =</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">case_when</span>(</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>          cmle_theta_est <span class="sc">==</span> <span class="cn">Inf</span> <span class="sc">|</span> cmle_theta_est <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">4</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>          , cmle_theta_est <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span> <span class="sc">|</span> cmle_theta_est <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">4</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(data)) {</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    numerator <span class="ot">=</span> <span class="fu">sum</span>(data[,i] <span class="sc">-</span> true_theta)</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>    bias_est <span class="ot">=</span> numerator <span class="sc">/</span> <span class="fu">length</span>(true_theta)</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    bias <span class="ot">=</span> <span class="fu">c</span>(bias, bias_est)</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(bias) <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">colnames</span>(data)[<span class="sc">-</span><span class="dv">1</span>], <span class="st">"_bias"</span>)</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(bias)</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>mad_estimator <span class="ot">=</span> <span class="cf">function</span>(data) {</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>  true_theta <span class="ot">=</span> data[,<span class="dv">1</span>]</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>  mad <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> </span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>    data <span class="sc">%&gt;%</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">prox_theta_est =</span></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>        <span class="fu">case_when</span>(</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>          prox_theta_est <span class="sc">==</span> <span class="cn">Inf</span> <span class="sc">|</span> prox_theta_est <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">4</span></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>          , prox_theta_est <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span> <span class="sc">|</span> prox_theta_est <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">4</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>          , <span class="cn">TRUE</span> <span class="sc">~</span> prox_theta_est</span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>      , <span class="at">cmle_theta_est =</span></span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>        <span class="fu">case_when</span>(</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>          cmle_theta_est <span class="sc">==</span> <span class="cn">Inf</span> <span class="sc">|</span> cmle_theta_est <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">4</span></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>          , cmle_theta_est <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span> <span class="sc">|</span> cmle_theta_est <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">4</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>          , <span class="cn">TRUE</span> <span class="sc">~</span> cmle_theta_est</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>      , <span class="at">jmle_theta_est =</span></span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>        <span class="fu">case_when</span>(</span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>          jmle_theta_est <span class="sc">==</span> <span class="cn">Inf</span> <span class="sc">|</span> jmle_theta_est <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">4</span></span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a>          , jmle_theta_est <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span> <span class="sc">|</span> jmle_theta_est <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">4</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a>          , <span class="cn">TRUE</span> <span class="sc">~</span> jmle_theta_est</span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a>      , <span class="at">eap_theta_est =</span></span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>        <span class="fu">case_when</span>(</span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a>          eap_theta_est <span class="sc">==</span> <span class="cn">Inf</span> <span class="sc">|</span> eap_theta_est <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">4</span></span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a>          , eap_theta_est <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span> <span class="sc">|</span> eap_theta_est <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">4</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>          , <span class="cn">TRUE</span> <span class="sc">~</span> eap_theta_est</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(data)) {</span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a>    numerator <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(data[,i] <span class="sc">-</span> true_theta))</span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a>    mad_est <span class="ot">=</span> numerator <span class="sc">/</span> (<span class="fu">length</span>(true_theta) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a>    mad <span class="ot">=</span> <span class="fu">c</span>(mad, mad_est)</span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(mad) <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">colnames</span>(data)[<span class="sc">-</span><span class="dv">1</span>], <span class="st">"_mad"</span>)</span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(mad)</span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-77"><a href="#cb33-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-78"><a href="#cb33-78" aria-hidden="true" tabindex="-1"></a>mse_estimator <span class="ot">=</span> <span class="cf">function</span>(data) {</span>
<span id="cb33-79"><a href="#cb33-79" aria-hidden="true" tabindex="-1"></a>  true_theta <span class="ot">=</span> data[,<span class="dv">1</span>]</span>
<span id="cb33-80"><a href="#cb33-80" aria-hidden="true" tabindex="-1"></a>  mse <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb33-81"><a href="#cb33-81" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-82"><a href="#cb33-82" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> </span>
<span id="cb33-83"><a href="#cb33-83" aria-hidden="true" tabindex="-1"></a>    data <span class="sc">%&gt;%</span></span>
<span id="cb33-84"><a href="#cb33-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-85"><a href="#cb33-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb33-86"><a href="#cb33-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">prox_theta_est =</span></span>
<span id="cb33-87"><a href="#cb33-87" aria-hidden="true" tabindex="-1"></a>        <span class="fu">case_when</span>(</span>
<span id="cb33-88"><a href="#cb33-88" aria-hidden="true" tabindex="-1"></a>          prox_theta_est <span class="sc">==</span> <span class="cn">Inf</span> <span class="sc">|</span> prox_theta_est <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">4</span></span>
<span id="cb33-89"><a href="#cb33-89" aria-hidden="true" tabindex="-1"></a>          , prox_theta_est <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span> <span class="sc">|</span> prox_theta_est <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">4</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb33-90"><a href="#cb33-90" aria-hidden="true" tabindex="-1"></a>          , <span class="cn">TRUE</span> <span class="sc">~</span> prox_theta_est</span>
<span id="cb33-91"><a href="#cb33-91" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb33-92"><a href="#cb33-92" aria-hidden="true" tabindex="-1"></a>      , <span class="at">cmle_theta_est =</span></span>
<span id="cb33-93"><a href="#cb33-93" aria-hidden="true" tabindex="-1"></a>        <span class="fu">case_when</span>(</span>
<span id="cb33-94"><a href="#cb33-94" aria-hidden="true" tabindex="-1"></a>          cmle_theta_est <span class="sc">==</span> <span class="cn">Inf</span> <span class="sc">|</span> cmle_theta_est <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">4</span></span>
<span id="cb33-95"><a href="#cb33-95" aria-hidden="true" tabindex="-1"></a>          , cmle_theta_est <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span> <span class="sc">|</span> cmle_theta_est <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">4</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb33-96"><a href="#cb33-96" aria-hidden="true" tabindex="-1"></a>          , <span class="cn">TRUE</span> <span class="sc">~</span> cmle_theta_est</span>
<span id="cb33-97"><a href="#cb33-97" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb33-98"><a href="#cb33-98" aria-hidden="true" tabindex="-1"></a>      , <span class="at">jmle_theta_est =</span></span>
<span id="cb33-99"><a href="#cb33-99" aria-hidden="true" tabindex="-1"></a>        <span class="fu">case_when</span>(</span>
<span id="cb33-100"><a href="#cb33-100" aria-hidden="true" tabindex="-1"></a>          jmle_theta_est <span class="sc">==</span> <span class="cn">Inf</span> <span class="sc">|</span> jmle_theta_est <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">4</span></span>
<span id="cb33-101"><a href="#cb33-101" aria-hidden="true" tabindex="-1"></a>          , jmle_theta_est <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span> <span class="sc">|</span> jmle_theta_est <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">4</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb33-102"><a href="#cb33-102" aria-hidden="true" tabindex="-1"></a>          , <span class="cn">TRUE</span> <span class="sc">~</span> jmle_theta_est</span>
<span id="cb33-103"><a href="#cb33-103" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb33-104"><a href="#cb33-104" aria-hidden="true" tabindex="-1"></a>      , <span class="at">eap_theta_est =</span></span>
<span id="cb33-105"><a href="#cb33-105" aria-hidden="true" tabindex="-1"></a>        <span class="fu">case_when</span>(</span>
<span id="cb33-106"><a href="#cb33-106" aria-hidden="true" tabindex="-1"></a>          eap_theta_est <span class="sc">==</span> <span class="cn">Inf</span> <span class="sc">|</span> eap_theta_est <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">4</span></span>
<span id="cb33-107"><a href="#cb33-107" aria-hidden="true" tabindex="-1"></a>          , eap_theta_est <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span> <span class="sc">|</span> eap_theta_est <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">4</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb33-108"><a href="#cb33-108" aria-hidden="true" tabindex="-1"></a>          , <span class="cn">TRUE</span> <span class="sc">~</span> eap_theta_est</span>
<span id="cb33-109"><a href="#cb33-109" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb33-110"><a href="#cb33-110" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb33-111"><a href="#cb33-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-112"><a href="#cb33-112" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(data)) {</span>
<span id="cb33-113"><a href="#cb33-113" aria-hidden="true" tabindex="-1"></a>    numerator <span class="ot">=</span> <span class="fu">sum</span>((data[,i] <span class="sc">-</span> true_theta)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb33-114"><a href="#cb33-114" aria-hidden="true" tabindex="-1"></a>    mse_est <span class="ot">=</span> numerator <span class="sc">/</span> (<span class="fu">length</span>(true_theta) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb33-115"><a href="#cb33-115" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-116"><a href="#cb33-116" aria-hidden="true" tabindex="-1"></a>    mse <span class="ot">=</span> <span class="fu">c</span>(mse, mse_est)</span>
<span id="cb33-117"><a href="#cb33-117" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-118"><a href="#cb33-118" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-119"><a href="#cb33-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(mse) <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">colnames</span>(data)[<span class="sc">-</span><span class="dv">1</span>], <span class="st">"_mse"</span>)</span>
<span id="cb33-120"><a href="#cb33-120" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-121"><a href="#cb33-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(mse)</span>
<span id="cb33-122"><a href="#cb33-122" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-123"><a href="#cb33-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-124"><a href="#cb33-124" aria-hidden="true" tabindex="-1"></a>rmse_estimator <span class="ot">=</span> <span class="cf">function</span>(data) {</span>
<span id="cb33-125"><a href="#cb33-125" aria-hidden="true" tabindex="-1"></a>  true_theta <span class="ot">=</span> data[,<span class="dv">1</span>]</span>
<span id="cb33-126"><a href="#cb33-126" aria-hidden="true" tabindex="-1"></a>  rmse <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb33-127"><a href="#cb33-127" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-128"><a href="#cb33-128" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> </span>
<span id="cb33-129"><a href="#cb33-129" aria-hidden="true" tabindex="-1"></a>    data <span class="sc">%&gt;%</span></span>
<span id="cb33-130"><a href="#cb33-130" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-131"><a href="#cb33-131" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb33-132"><a href="#cb33-132" aria-hidden="true" tabindex="-1"></a>      <span class="at">prox_theta_est =</span></span>
<span id="cb33-133"><a href="#cb33-133" aria-hidden="true" tabindex="-1"></a>        <span class="fu">case_when</span>(</span>
<span id="cb33-134"><a href="#cb33-134" aria-hidden="true" tabindex="-1"></a>          prox_theta_est <span class="sc">==</span> <span class="cn">Inf</span> <span class="sc">|</span> prox_theta_est <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">4</span></span>
<span id="cb33-135"><a href="#cb33-135" aria-hidden="true" tabindex="-1"></a>          , prox_theta_est <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span> <span class="sc">|</span> prox_theta_est <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">4</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb33-136"><a href="#cb33-136" aria-hidden="true" tabindex="-1"></a>          , <span class="cn">TRUE</span> <span class="sc">~</span> prox_theta_est</span>
<span id="cb33-137"><a href="#cb33-137" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb33-138"><a href="#cb33-138" aria-hidden="true" tabindex="-1"></a>      , <span class="at">cmle_theta_est =</span></span>
<span id="cb33-139"><a href="#cb33-139" aria-hidden="true" tabindex="-1"></a>        <span class="fu">case_when</span>(</span>
<span id="cb33-140"><a href="#cb33-140" aria-hidden="true" tabindex="-1"></a>          cmle_theta_est <span class="sc">==</span> <span class="cn">Inf</span> <span class="sc">|</span> cmle_theta_est <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">4</span></span>
<span id="cb33-141"><a href="#cb33-141" aria-hidden="true" tabindex="-1"></a>          , cmle_theta_est <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span> <span class="sc">|</span> cmle_theta_est <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">4</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb33-142"><a href="#cb33-142" aria-hidden="true" tabindex="-1"></a>          , <span class="cn">TRUE</span> <span class="sc">~</span> cmle_theta_est</span>
<span id="cb33-143"><a href="#cb33-143" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb33-144"><a href="#cb33-144" aria-hidden="true" tabindex="-1"></a>      , <span class="at">jmle_theta_est =</span></span>
<span id="cb33-145"><a href="#cb33-145" aria-hidden="true" tabindex="-1"></a>        <span class="fu">case_when</span>(</span>
<span id="cb33-146"><a href="#cb33-146" aria-hidden="true" tabindex="-1"></a>          jmle_theta_est <span class="sc">==</span> <span class="cn">Inf</span> <span class="sc">|</span> jmle_theta_est <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">4</span></span>
<span id="cb33-147"><a href="#cb33-147" aria-hidden="true" tabindex="-1"></a>          , jmle_theta_est <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span> <span class="sc">|</span> jmle_theta_est <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">4</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb33-148"><a href="#cb33-148" aria-hidden="true" tabindex="-1"></a>          , <span class="cn">TRUE</span> <span class="sc">~</span> jmle_theta_est</span>
<span id="cb33-149"><a href="#cb33-149" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb33-150"><a href="#cb33-150" aria-hidden="true" tabindex="-1"></a>      , <span class="at">eap_theta_est =</span></span>
<span id="cb33-151"><a href="#cb33-151" aria-hidden="true" tabindex="-1"></a>        <span class="fu">case_when</span>(</span>
<span id="cb33-152"><a href="#cb33-152" aria-hidden="true" tabindex="-1"></a>          eap_theta_est <span class="sc">==</span> <span class="cn">Inf</span> <span class="sc">|</span> eap_theta_est <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">4</span></span>
<span id="cb33-153"><a href="#cb33-153" aria-hidden="true" tabindex="-1"></a>          , eap_theta_est <span class="sc">==</span> <span class="sc">-</span><span class="cn">Inf</span> <span class="sc">|</span> eap_theta_est <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">4</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb33-154"><a href="#cb33-154" aria-hidden="true" tabindex="-1"></a>          , <span class="cn">TRUE</span> <span class="sc">~</span> eap_theta_est</span>
<span id="cb33-155"><a href="#cb33-155" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb33-156"><a href="#cb33-156" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb33-157"><a href="#cb33-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-158"><a href="#cb33-158" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(data)) {</span>
<span id="cb33-159"><a href="#cb33-159" aria-hidden="true" tabindex="-1"></a>    numerator <span class="ot">=</span> <span class="fu">sum</span>((data[,i] <span class="sc">-</span> true_theta)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb33-160"><a href="#cb33-160" aria-hidden="true" tabindex="-1"></a>    rmse_est <span class="ot">=</span> <span class="fu">sqrt</span>(numerator <span class="sc">/</span> (<span class="fu">length</span>(true_theta) <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb33-161"><a href="#cb33-161" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-162"><a href="#cb33-162" aria-hidden="true" tabindex="-1"></a>    rmse <span class="ot">=</span> <span class="fu">c</span>(rmse, rmse_est)</span>
<span id="cb33-163"><a href="#cb33-163" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-164"><a href="#cb33-164" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-165"><a href="#cb33-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(rmse) <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">colnames</span>(data)[<span class="sc">-</span><span class="dv">1</span>], <span class="st">"_rmse"</span>)</span>
<span id="cb33-166"><a href="#cb33-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-167"><a href="#cb33-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(rmse)</span>
<span id="cb33-168"><a href="#cb33-168" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-169"><a href="#cb33-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-170"><a href="#cb33-170" aria-hidden="true" tabindex="-1"></a>se_estimator <span class="ot">=</span> <span class="cf">function</span>(data) { <span class="co"># not vectorized like the others</span></span>
<span id="cb33-171"><a href="#cb33-171" aria-hidden="true" tabindex="-1"></a>  mean_est <span class="ot">=</span> <span class="fu">mean</span>(data, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-172"><a href="#cb33-172" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(data))</span>
<span id="cb33-173"><a href="#cb33-173" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-174"><a href="#cb33-174" aria-hidden="true" tabindex="-1"></a>  data_clean <span class="ot">&lt;-</span> data[<span class="sc">!</span><span class="fu">is.na</span>(data)]</span>
<span id="cb33-175"><a href="#cb33-175" aria-hidden="true" tabindex="-1"></a>  numerator <span class="ot">=</span> <span class="fu">sum</span>((data_clean <span class="sc">-</span> mean_est)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb33-176"><a href="#cb33-176" aria-hidden="true" tabindex="-1"></a>  se_est <span class="ot">=</span> <span class="fu">sqrt</span>(numerator <span class="sc">/</span> (n <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb33-177"><a href="#cb33-177" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-178"><a href="#cb33-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(se_est)</span>
<span id="cb33-179"><a href="#cb33-179" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-180"><a href="#cb33-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-181"><a href="#cb33-181" aria-hidden="true" tabindex="-1"></a>conditions <span class="ot">&lt;-</span></span>
<span id="cb33-182"><a href="#cb33-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">readRDS</span>(<span class="st">"results/conditions.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mean-bias" class="level3">
<h3 class="anchored" data-anchor-id="mean-bias">Mean Bias</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>loaded_estimates <span class="ot">&lt;-</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">readRDS</span>(estimates_files_list[<span class="dv">1</span>])</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>all_bias_estimates <span class="ot">&lt;-</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  loaded_estimates <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(<span class="st">'thetas'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(bias_estimator) <span class="sc">%&gt;%</span> </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">filename =</span> estimates_files_list[<span class="dv">1</span>] <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">"simdata/"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(conditions)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(estimates_files_list)) {</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  loaded_estimates <span class="ot">&lt;-</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">readRDS</span>(estimates_files_list[i])</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>(</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>      purrr<span class="sc">:::</span><span class="fu">map</span>(loaded_estimates, <span class="st">'thetas'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>        purrr<span class="sc">::</span><span class="fu">map</span>(bias_estimator)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">error =</span> <span class="cf">function</span>(e)</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">'error'</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">class</span>(test) <span class="sc">==</span> <span class="st">'list'</span>) {</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>    all_bias_estimates <span class="ot">&lt;-</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>      all_bias_estimates <span class="sc">%&gt;%</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_rows</span>(</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>        purrr<span class="sc">::</span><span class="fu">map</span>(loaded_estimates, <span class="st">'thetas'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">map</span>(bias_estimator) <span class="sc">%&gt;%</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>          <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">filename =</span> estimates_files_list[i] <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">"simdata/"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>          <span class="fu">left_join</span>(conditions)</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (test <span class="sc">==</span> <span class="st">'error'</span>) {</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>    all_bias_estimates <span class="ot">&lt;-</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>      all_bias_estimates <span class="sc">%&gt;%</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_rows</span>(</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>        loaded_estimates <span class="sc">%&gt;%</span>   </span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">:::</span><span class="fu">map</span>(bias_estimator) <span class="sc">%&gt;%</span></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>          <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">filename =</span> estimates_files_list[i] <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">"simdata/"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>          <span class="fu">left_join</span>(conditions)</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Something went wrong."</span>)</span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>mean_bias_by_condition <span class="ot">&lt;-</span></span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>  all_bias_estimates <span class="sc">%&gt;%</span> </span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition) <span class="sc">%&gt;%</span> </span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"_bias"</span>), \(x) <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(x)), <span class="at">.names =</span> <span class="st">"n_{.col}"</span>)</span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>    , <span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"_bias"</span>), \(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.names =</span> <span class="st">"mean_{.col}"</span>)</span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">%&gt;%</span></span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">"mean_n_"</span>))</span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a>se_bias_by_condition <span class="ot">&lt;-</span></span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a>  all_bias_estimates <span class="sc">%&gt;%</span></span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition) <span class="sc">%&gt;%</span></span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"_bias"</span>), \(x) <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(x)), <span class="at">.names =</span> <span class="st">"n_{.col}"</span>)</span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a>    , <span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"_bias"</span>), \(x) <span class="fu">se_estimator</span>(x), <span class="at">.names =</span> <span class="st">"se_{.col}"</span>)</span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">"se_n_"</span>))</span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a>all_bias_estimates <span class="sc">%&gt;%</span></span>
<span id="cb34-69"><a href="#cb34-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">"results/01_all_bias_estimates.RDS"</span>)</span>
<span id="cb34-70"><a href="#cb34-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-71"><a href="#cb34-71" aria-hidden="true" tabindex="-1"></a>mean_bias_by_condition <span class="sc">%&gt;%</span></span>
<span id="cb34-72"><a href="#cb34-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">"results/01_mean_bias_by_condition.RDS"</span>)</span>
<span id="cb34-73"><a href="#cb34-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-74"><a href="#cb34-74" aria-hidden="true" tabindex="-1"></a>se_bias_by_condition <span class="sc">%&gt;%</span></span>
<span id="cb34-75"><a href="#cb34-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">'results/01_se_bias_estimates.RDS'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mean-absolute-difference" class="level3">
<h3 class="anchored" data-anchor-id="mean-absolute-difference">Mean Absolute Difference</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>loaded_estimates <span class="ot">&lt;-</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">readRDS</span>(estimates_files_list[<span class="dv">1</span>])</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>all_mad_estimates <span class="ot">&lt;-</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  loaded_estimates <span class="sc">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(<span class="st">'thetas'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(mad_estimator) <span class="sc">%&gt;%</span> </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">filename =</span> estimates_files_list[<span class="dv">1</span>] <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">"simdata/"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(conditions)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(estimates_files_list)) {</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  loaded_estimates <span class="ot">&lt;-</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">readRDS</span>(estimates_files_list[i])</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>(</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>      purrr<span class="sc">:::</span><span class="fu">map</span>(loaded_estimates, <span class="st">'thetas'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>        purrr<span class="sc">::</span><span class="fu">map</span>(mad_estimator)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">error =</span> <span class="cf">function</span>(e)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">'error'</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">class</span>(test) <span class="sc">==</span> <span class="st">'list'</span>) {</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>    all_mad_estimates <span class="ot">&lt;-</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>      all_mad_estimates <span class="sc">%&gt;%</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_rows</span>(</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>        purrr<span class="sc">::</span><span class="fu">map</span>(loaded_estimates, <span class="st">'thetas'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">map</span>(mad_estimator) <span class="sc">%&gt;%</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>          <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">filename =</span> estimates_files_list[i] <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">"simdata/"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>          <span class="fu">left_join</span>(conditions)</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (test <span class="sc">==</span> <span class="st">'error'</span>) {</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>    all_mad_estimates <span class="ot">&lt;-</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>      all_mad_estimates <span class="sc">%&gt;%</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_rows</span>(</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>        loaded_estimates <span class="sc">%&gt;%</span>   </span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">:::</span><span class="fu">map</span>(mad_estimator) <span class="sc">%&gt;%</span></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>          <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">filename =</span> estimates_files_list[i] <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">"simdata/"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>          <span class="fu">left_join</span>(conditions)</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Something went wrong."</span>)</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>mean_mad_by_condition <span class="ot">&lt;-</span></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>  all_mad_estimates <span class="sc">%&gt;%</span> </span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition) <span class="sc">%&gt;%</span> </span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"_mad"</span>), \(x) <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(x)), <span class="at">.names =</span> <span class="st">"n_{.col}"</span>)</span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>    , <span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"_mad"</span>), \(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.names =</span> <span class="st">"mean_{.col}"</span>)</span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">%&gt;%</span></span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">"mean_n_"</span>))</span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>se_mad_by_condition <span class="ot">&lt;-</span></span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>  all_mad_estimates <span class="sc">%&gt;%</span></span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition) <span class="sc">%&gt;%</span></span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"_mad"</span>), \(x) <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(x)), <span class="at">.names =</span> <span class="st">"n_{.col}"</span>)</span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>    , <span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"_mad"</span>), \(x) <span class="fu">se_estimator</span>(x), <span class="at">.names =</span> <span class="st">"se_{.col}"</span>)</span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">"se_n_"</span>))</span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a>all_mad_estimates <span class="sc">%&gt;%</span></span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">"results/02_all_mad_estimates.RDS"</span>)</span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>mean_mad_by_condition <span class="sc">%&gt;%</span></span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">"results/02_mean_mad_by_condition.RDS"</span>)</span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>se_mad_by_condition <span class="sc">%&gt;%</span></span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">"results/02_se_mad_by_condition.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mean-square-error" class="level3">
<h3 class="anchored" data-anchor-id="mean-square-error">Mean Square Error</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>loaded_estimates <span class="ot">&lt;-</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">readRDS</span>(estimates_files_list[<span class="dv">1</span>])</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>all_mse_estimates <span class="ot">&lt;-</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  loaded_estimates <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(<span class="st">'thetas'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(mse_estimator) <span class="sc">%&gt;%</span> </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">filename =</span> estimates_files_list[<span class="dv">1</span>] <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">"simdata/"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(conditions)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(estimates_files_list)) {</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  loaded_estimates <span class="ot">&lt;-</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">readRDS</span>(estimates_files_list[i])</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>(</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>      purrr<span class="sc">:::</span><span class="fu">map</span>(loaded_estimates, <span class="st">'thetas'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>        purrr<span class="sc">::</span><span class="fu">map</span>(mse_estimator)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">error =</span> <span class="cf">function</span>(e)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">'error'</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">class</span>(test) <span class="sc">==</span> <span class="st">'list'</span>) {</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>    all_mse_estimates <span class="ot">&lt;-</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>      all_mse_estimates <span class="sc">%&gt;%</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_rows</span>(</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>        purrr<span class="sc">::</span><span class="fu">map</span>(loaded_estimates, <span class="st">'thetas'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">map</span>(mse_estimator) <span class="sc">%&gt;%</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>          <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">filename =</span> estimates_files_list[i] <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">"simdata/"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>          <span class="fu">left_join</span>(conditions)</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (test <span class="sc">==</span> <span class="st">'error'</span>) {</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>    all_mse_estimates <span class="ot">&lt;-</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>      all_mse_estimates <span class="sc">%&gt;%</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_rows</span>(</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>        loaded_estimates <span class="sc">%&gt;%</span>   </span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">:::</span><span class="fu">map</span>(mse_estimator) <span class="sc">%&gt;%</span></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>          <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">filename =</span> estimates_files_list[i] <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">"simdata/"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>          <span class="fu">left_join</span>(conditions)</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Something went wrong."</span>)</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>mean_mse_by_condition <span class="ot">&lt;-</span></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>  all_mse_estimates <span class="sc">%&gt;%</span> </span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition) <span class="sc">%&gt;%</span> </span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"_mse"</span>), \(x) <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(x)), <span class="at">.names =</span> <span class="st">"n_{.col}"</span>)</span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>    , <span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"_mse"</span>), \(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.names =</span> <span class="st">"mean_{.col}"</span>)</span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">%&gt;%</span></span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">"mean_n_"</span>))</span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a>se_mse_by_condition <span class="ot">&lt;-</span></span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>  all_mse_estimates <span class="sc">%&gt;%</span></span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition) <span class="sc">%&gt;%</span></span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"_mse"</span>), \(x) <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(x)), <span class="at">.names =</span> <span class="st">"n_{.col}"</span>)</span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>    , <span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"_mse"</span>), \(x) <span class="fu">se_estimator</span>(x), <span class="at">.names =</span> <span class="st">"se_{.col}"</span>)</span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">"se_n_"</span>))</span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a>all_mse_estimates <span class="sc">%&gt;%</span></span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">"results/03_all_mse_estimates.RDS"</span>)</span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a>mean_mse_by_condition <span class="sc">%&gt;%</span></span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">"results/03_mean_mse_by_condition.RDS"</span>)</span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a>se_mse_by_condition <span class="sc">%&gt;%</span></span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">'results/03_se_mse_estimates.RDS'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="root-mean-square-error" class="level3">
<h3 class="anchored" data-anchor-id="root-mean-square-error">Root Mean Square Error</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>loaded_estimates <span class="ot">&lt;-</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">readRDS</span>(estimates_files_list[<span class="dv">1</span>])</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>all_rmse_estimates <span class="ot">&lt;-</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  loaded_estimates <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(<span class="st">'thetas'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(rmse_estimator) <span class="sc">%&gt;%</span> </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">filename =</span> estimates_files_list[<span class="dv">1</span>] <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">"simdata/"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(conditions)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(estimates_files_list)) {</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  loaded_estimates <span class="ot">&lt;-</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">readRDS</span>(estimates_files_list[i])</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>(</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>      purrr<span class="sc">:::</span><span class="fu">map</span>(loaded_estimates, <span class="st">'thetas'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>        purrr<span class="sc">::</span><span class="fu">map</span>(rmse_estimator)</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>        ,</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">error =</span> <span class="cf">function</span>(e)</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">'error'</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">class</span>(test) <span class="sc">==</span> <span class="st">'list'</span>) {</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>    all_rmse_estimates <span class="ot">&lt;-</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>      all_rmse_estimates <span class="sc">%&gt;%</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_rows</span>(</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>        purrr<span class="sc">::</span><span class="fu">map</span>(loaded_estimates, <span class="st">'thetas'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">map</span>(rmse_estimator) <span class="sc">%&gt;%</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>          <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">filename =</span> estimates_files_list[i] <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">"simdata/"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>          <span class="fu">left_join</span>(conditions)</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (test <span class="sc">==</span> <span class="st">'error'</span>) {</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>    all_rmse_estimates <span class="ot">&lt;-</span></span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>      all_rmse_estimates <span class="sc">%&gt;%</span></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_rows</span>(</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>        loaded_estimates <span class="sc">%&gt;%</span>   </span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">:::</span><span class="fu">map</span>(rmse_estimator) <span class="sc">%&gt;%</span></span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>          <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">filename =</span> estimates_files_list[i] <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">"simdata/"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>          <span class="fu">left_join</span>(conditions)</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Something went wrong."</span>)</span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a>mean_rmse_by_condition <span class="ot">&lt;-</span></span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a>  all_rmse_estimates <span class="sc">%&gt;%</span> </span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition) <span class="sc">%&gt;%</span> </span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"_rmse"</span>), \(x) <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(x)), <span class="at">.names =</span> <span class="st">"n_{.col}"</span>)</span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a>    , <span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"_rmse"</span>), \(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.names =</span> <span class="st">"mean_{.col}"</span>)</span>
<span id="cb37-55"><a href="#cb37-55" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">%&gt;%</span></span>
<span id="cb37-56"><a href="#cb37-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">"mean_n_"</span>))</span>
<span id="cb37-57"><a href="#cb37-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-58"><a href="#cb37-58" aria-hidden="true" tabindex="-1"></a>se_rmse_by_condition <span class="ot">&lt;-</span></span>
<span id="cb37-59"><a href="#cb37-59" aria-hidden="true" tabindex="-1"></a>  all_rmse_estimates <span class="sc">%&gt;%</span></span>
<span id="cb37-60"><a href="#cb37-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition) <span class="sc">%&gt;%</span></span>
<span id="cb37-61"><a href="#cb37-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb37-62"><a href="#cb37-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"_rmse"</span>), \(x) <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(x)), <span class="at">.names =</span> <span class="st">"n_{.col}"</span>)</span>
<span id="cb37-63"><a href="#cb37-63" aria-hidden="true" tabindex="-1"></a>    , <span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"_rmse"</span>), \(x) <span class="fu">se_estimator</span>(x), <span class="at">.names =</span> <span class="st">"se_{.col}"</span>)</span>
<span id="cb37-64"><a href="#cb37-64" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb37-65"><a href="#cb37-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">"se_n_"</span>))</span>
<span id="cb37-66"><a href="#cb37-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-67"><a href="#cb37-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-68"><a href="#cb37-68" aria-hidden="true" tabindex="-1"></a>all_rmse_estimates <span class="sc">%&gt;%</span></span>
<span id="cb37-69"><a href="#cb37-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">"results/04_all_rmse_estimates.RDS"</span>)</span>
<span id="cb37-70"><a href="#cb37-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-71"><a href="#cb37-71" aria-hidden="true" tabindex="-1"></a>mean_rmse_by_condition <span class="sc">%&gt;%</span></span>
<span id="cb37-72"><a href="#cb37-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">"results/04_mean_rmse_by_condition.RDS"</span>)</span>
<span id="cb37-73"><a href="#cb37-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-74"><a href="#cb37-74" aria-hidden="true" tabindex="-1"></a>se_rmse_by_condition <span class="sc">%&gt;%</span></span>
<span id="cb37-75"><a href="#cb37-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">'results/04_se_rmse_estimates.RDS'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="linear-models" class="level2">
<h2 class="anchored" data-anchor-id="linear-models">Linear Models</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>all_bias_estimates <span class="ot">&lt;-</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">'results/01_all_bias_estimates.RDS'</span>) </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>mean_bias_estimates <span class="ot">&lt;-</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">'results/01_mean_bias_by_condition.RDS'</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>se_bias_estimates <span class="ot">&lt;-</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">'results/01_se_bias_estimates.RDS'</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>long_bias_estimates <span class="ot">&lt;-</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  all_bias_estimates <span class="sc">%&gt;%</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">'_bias'</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    , <span class="at">names_to =</span> <span class="st">'method_'</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    , <span class="at">values_to =</span> <span class="st">'bias'</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">method_ =</span> <span class="fu">str_remove</span>(method_, <span class="st">'_theta_est_bias'</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"prox"</span>, <span class="st">"jmle"</span>, <span class="st">"cmle"</span>, <span class="st">"eap"</span>))</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    , <span class="at">Item_and_Person_Params =</span> <span class="fu">factor</span>(Item_and_Person_Params)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>linear_model_bias <span class="ot">&lt;-</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(bias <span class="sc">~</span> Item_and_Person_Params <span class="sc">*</span> N <span class="sc">*</span> method_, <span class="at">data =</span> long_bias_estimates) </span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>linear_model_bias <span class="sc">%&gt;%</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>linear_model_bias <span class="sc">%&gt;%</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>()</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>linear_model_bias <span class="sc">%&gt;%</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.intercept =</span> <span class="cn">FALSE</span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>    , <span class="at">show.reflvl =</span> <span class="cn">TRUE</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>